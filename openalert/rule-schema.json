{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/product.schema.json",
  "title": "CMCCS SIEM rule specification V1.0.0 (2024-12-11)",
  "description": "Schema of rule in Log Correlation module",
  "type": "object",
  "required": ["id", "name", "query"],
  "properties":{
    "id": {
      "type": "string",
      "format": "uuid"
    },
    "name": {
      "type": "string"
    },
    "query": {
      "type": "object",
      "required": ["condition"],
      "additionalProperties": {
        "anyOf": [
          {
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "object",
                  "items": {
                    "type": "string"
                  }
                }
              ]
            }
          },
          {
            "type": "object",
            "items": {
              "type": "string"
            }
          }
        ],
        "properties": {
          "condition": {
            "type": "string"
          }
        }
      }
    },
    "references": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "tags": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "author": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "enabled": {
      "type": "boolean"
    },
    "status": {
      "type": "string",
      "oneOf": [
        {
          "const": "stable",
          "description": "The rule didn't produce any obvious false positives in multiple environments over a long period of time"
        },
        {
          "const": "test",
          "description": "The rule doesn't show any obvious false positives on a limited set of test systems"
        },
        {
          "const": "experimental",
          "description": "A new rule that hasn't been tested outside of lab environments and could lead to many false positives"
        }
      ]
    },
    "date": {
      "type": "string",
      "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
    },
    "modified": {
      "type": "string",
      "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
    },
    "index": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "exceptions": {
      "type": "object",
      "required": ["condition"],
      "additionalProperties": {
        "anyOf": [
          {
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "object",
                  "items": {
                    "type": "string"
                  }
                }
              ]
            }
          },
          {
            "type": "object",
            "items": {
              "type": "string"
            }
          }
        ],
        "properties": {
          "condition": {
            "type": "string"
          }
        }
      }
    },
    "exceptionsList": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "fields": {
      "type": "object",
      "properties": {
        "includes": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string"
          }
        },
        "excludes": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string"
          }
        }
      }
    },
    "riskscore": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },
    "severity": {
      "type": "string",
      "oneOf": [
        {
          "const": "informational"
        },
        {
          "const": "low"
        },
        {
          "const": "medium"
        },
        {
          "const": "high"
        },
        {
          "const": "critical"
        }
      ]
    },
    "falsePositives": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "schedule": {
      "type": "object",
      "properties": {
        "interval": {
          "type": "string"
        },
        "buffer_time": {
          "type": "string"
        }
      }
    },
    "maxSignals": {
      "type": "number"
    },
    "threat": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "framework": {
            "type": "string"
          },
          "tactic": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "reference": {
                "type": "string",
                "format": "uri"
              }
            },
            "required": ["id", "name"]
          },
          "technique": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "reference": {
                  "type": "string",
                  "format": "uri"
                },
                "subTechnique": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      },
                      "reference": {
                        "type": "string",
                        "format": "uri"
                      }
                    },
                    "required": ["id", "name"]
                  }
                }
              },
              "required": ["id", "name"]
            }
          }
        },
        "required": ["framework", "tactic"]
      }
    },
    "actions": {
      "type": "array"
    }
  }
}